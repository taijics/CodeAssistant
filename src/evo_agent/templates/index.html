{% extends "base.html" %}
{% block content %}
<div class="layout-grid">
  <!-- 左侧：新建 / 编辑项目 -->
  <section class="card card-elevated">
    <div class="card-header">
      <h2>新增项目</h2>
      <p class="muted small">每个项目对应一个本地代码根目录，可被 Evo Agent 扫描与管理。</p>
    </div>
    <form method="post" action="/projects" class="form vertical">
      <label>项目名称</label>
      <input type="text" name="name" placeholder="例如：电商后台系统" required />

      <label>项目根目录（绝对路径）</label>
      <input type="text" name="root" placeholder="C:/dev/my-project 或 /home/me/my-project" required />

      <label>功能简介</label>
      <input type="text" name="description" placeholder="例如：B 端运营管理后台 + 移动端 API" />

      <p class="form-actions">
        <button type="submit" class="btn-primary">创建项目</button>
      </p>
    </form>
  </section>

  <!-- 右侧：项目列表 -->
  <section class="card card-elevated flex-1">
    <div class="card-header row-between">
      <div>
        <h2>项目列表</h2>
        <p class="muted small">团队所有项目一览，可以快速进入详情、生成 Spec 与查看统计。</p>
      </div>
    </div>

    {% if projects %}
      <div class="project-table">
        <div class="project-table-header">
          <span>项目</span>
          <span>简介</span>
          <span>文件数</span>
          <span>修改次数</span>
          <span>创建时间</span>
          <span>操作</span>
        </div>
        <div class="project-table-body">
          {% for p in projects %}
          <div class="project-row">
            <div class="cell main-cell">
              <div class="proj-name">
                <a href="/projects/{{ p.id }}">{{ p.name }}</a>
              </div>
              <div class="proj-path muted small">{{ p.root }}</div>
            </div>
            <div class="cell desc-cell">
              <span class="muted small">{{ p.description or '—' }}</span>
            </div>
            <div class="cell center-cell">
              <div class="kpi">{{ p.project_file_count or '—' }}</div>
              <div class="muted tiny">files</div>
            </div>
            <div class="cell center-cell">
              <div class="kpi">{{ p.config.mod_count or '0' }}</div>
              <div class="muted tiny">mods</div>
            </div>
            <div class="cell">
              <span class="muted tiny">
                {{ p.created_at or '—' }}
              </span>
            </div>
            <div class="cell actions-cell">
              <a class="btn-ghost" href="/projects/{{ p.id }}">详情</a>
              <!-- 删除按钮占位，后面可以接 /projects/{pid}/delete -->
              <!--
              <form method="post" action="/projects/{{ p.id }}/delete" style="display:inline">
                <button class="btn-ghost danger" onclick="return confirm('确认删除该项目？')">删除</button>
              </form>
              -->
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    {% else %}
      <p class="muted">暂无项目，先在左侧创建一个。</p>
    {% endif %}
  </section>
</div>
{% endblock %}